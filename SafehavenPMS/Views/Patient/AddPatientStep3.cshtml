@model SafehavenPMS.ViewModel.AddPatientStep3ViewModel

@{
    ViewBag.Title = "Patients";

    var confirmationModel = ViewBag.ConfirmationModel as SafehavenPMS.ViewModel.ConfirmationViewModel;
}

@* Content Header *@
<div class="header">
    <div class="d-flex justify-content-between align-items-center mb-2">
        <div class="d-flex align-items-center">
            <i class='bx bxs-user-detail fs-2 me-2'></i>
            <span class="text-custom" style="font-size:25px">@ViewBag.Title</span>
        </div>
    </div>
    <hr class="mt-0 mb-2" />
</div>

@* Add patient Content *@
<div class="patient-form-container ">
    <div class="d-flex align-items-center mb-4">
        <i class='bx bxs-user-circle fs-2 me-2'></i>
        <h4 class="text-custom mb-0">Add Patient</h4>
    </div>

    <div class="d-flex flex-row justify-content-between align-items-center title">
        <hr class="flex-grow-1 mx-2" />
        <span style="color:#767667"><strong>Case Details</strong></span>
        <hr class="flex-grow-1 mx-2" />
    </div>

    <form asp-controller="Patient" asp-action="AddPatientStep3" method="post">
        <div class="row">
            @* Patient's Date of Intake *@
            <div class="col-md-6 form-group">
                <label asp-for="DateOfIntake" class="form-label">Date of Intake</label>
                <input type="date" class="form-control" asp-for="DateOfIntake" />
                <span asp-validation-for="DateOfIntake" class="text-danger"></span>
            </div>

            <div class="col-md-6 form-group">
                <label asp-for="DateOfReferral" class="form-label">Date of Referral</label>
                <input type="date" class="form-control" asp-for="DateOfReferral"/>
                <span asp-validation-for="DateOfReferral" class="text-danger"></span>

            </div>


            @*Affiliation*@
            <div class="col-md-12 form-group">
                <label asp-for="Affilation" class="form-label">Affiliation</label>
                <input type="text" class="form-control" asp-for="Affilation" />
                <span asp-validation-for="Affilation" class="text-danger"></span>
            </div>

            <div class="col-md-6 form-group">
                <label asp-for="ReferredBy" class="form-label">Referred By</label>
                <input type="text" class="form-control" asp-for="ReferredBy" />
                <span asp-validation-for="ReferredBy"class="text-danger"></span>
            </div>

            <div class="col-md-6 form-group">
                <label asp-for="AccompaniedBy" class="form-label">Accompanied By</label>
                <input type="text" class="form-control" asp-for="AccompaniedBy" />
                <span asp-validation-for="AccompaniedBy" class="text-danger"></span>
            </div>

            @*Assign Physicisn*@
            <div class="col-md-12 form-group">
                <label asp-for="Physician" class="form-label">Physician</label>
                <select class="form-select" asp-for="Physician">
                    <option value="" selected disabled><i>--Select--</i></option>
                    <option>Sample1</option>
                    <option>Sample2</option>
                    <option>Sample3</option>
                    <option>Sample4</option>
                </select>
                <span asp-validation-for="Physician" class="text-danger"></span>
            </div>

        </div>

        @* Indicator *@
        <div class="indicator">
            <div class="inactive"></div>
            <div class="inactive"></div>
            <div class="active"></div>
        </div>

        @* Form Navigation *@
        <div class="d-flex justify-content-end mt-4">
            <button type="button" class="btn-cancel" onclick="history.back()">Back</button>
            <button type="submit" class="btn btn-next">Next</button>
        </div>
    </form>
</div>

<!-- Modal Rendering -->
@if (confirmationModel != null)
{
    @await Html.PartialAsync("ConfirmationPartial", confirmationModel)
}


@* Specific design for this page *@
<style>


    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-control {
        background-color: #f8f8f8;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        padding: 0.5rem 1rem;
    }

    .form-select {
        background-color: #f8f8f8;
        border: 1px solid #e0e0e0;
        border-radius: 6px;
        padding: 0.5rem 1rem;
    }

    .btn-next {
        background-color: #00A3B4;
        color: white;
        padding: 0.5rem 2rem;
        border-radius: 6px;
        border: none;
    }

    .btn-cancel {
        background-color: transparent;
        color: #767676;
        padding: 0.5rem 2rem;
        border: 2px solid #767676;
        border-radius: 6px;
        margin-right: 1rem;
    }

        .btn-cancel:hover {
            transform: translateY(-1px);
        }

    .indicator {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 8px;
        margin: 2rem 0;
    }

        .indicator div {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            transition: all 0.3s ease;
        }

        .indicator .active {
            background-color: #00A3B4;
        }

        .indicator .inactive {
            background-color: #E0E0E0;
        }

    .image-upload-container {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1rem;
        margin-top: 1rem;
    }

    .preview-area {
        width: 197px;
        height: 197px;
        border-radius: 50%;
        overflow: hidden;
        background-color: #f8f8f8;
        border: 2px solid #e0e0e0;
        display: flex;
        align-items: center;
        justify-content: center;
    }

        .preview-area img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

    .upload-button {
        background-color: white;
        color: #00A3B4;
        border: 2px solid #00A3B4;
        padding: 0.5rem 1.5rem;
        border-radius: 6px;
        cursor: pointer;
        display: inline-flex;
        align-items: center;
        transition: all 0.3s ease;
    }

        .upload-button:hover {
            background-color: #00A3B4;
            color: white;
            transform: translateY(-1px);
        }

</style>

<!-- Scripts -->
@section Scripts {
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

        document.addEventListener('DOMContentLoaded', function () {
            var form = document.querySelector('form[asp-action="AddPatientStep3"]');
            if (form) {
                form.addEventListener('submit', function () {
                    document.getElementById('loadingOverlay').style.display = 'flex';
                });
            }
        });

    @if (ViewBag.ShowModal == true)
    {
        <script>
            var confirmationModal = new bootstrap.Modal(document.getElementById('confirmationModal'));
            confirmationModal.show();
        </script>
    }
}